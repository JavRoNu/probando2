---
title: "Datos no vacunados"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,warning = FALSE,message = FALSE)
```

## Lectura de los datos

```{r}
library(foreign)

datos <- read.spss("C:/Users/javro/Documents/probando2/datos/3340.sav",use.value.labels = T,to.data.frame = T)
```

## Selección variables y transformaciones


- P5:¿Se ha vacunado Ud. del COVID-19?

- P5B:¿Cuál es la razón principal por la que no se vacunaría
cuando llegase su turno?

- P7: ¿Ante los riesgos de contagio de coronavirus, ¿cree Ud.
que habría que obligar a todas las personas a
vacunarse aunque no quisieran hacerlo?

- P.22 Suponiendo que mañana se celebrasen nuevamente
elecciones generales, es decir, al Parlamento español,
¿a qué partido votaría Ud.? (RESPUESTA
ESPONTÁNEA, ¡¡NO LEER LAS OPCIONES DE
RESPUESTA!!).(**INTENCIONGR**)


```{r}

estas <- c("SEXO","EDAD","P5","P5B","P7","INTENCIONGR")

main6 <- c("PP","PSOE","Unidas Podemos","VOX","Ciudadanos")


datos <- datos[,estas]

# convertir a numerico
datos$EDAD <- as.numeric(as.character(datos$EDAD))

# categorica ordinal con 
datos$EDAD2 <- cut(datos$EDAD,breaks = 6,ordered_result = T)

# Voto
datos$INTENCIONGR <- as.character(datos$INTENCIONGR)

datos$INTENCIONGR[!datos$INTENCIONGR %in% main6 ] <- NA

datos$INTENCIONGR <- factor(datos$INTENCIONGR)

# Variable dummy 
datos$oblig <- 0
datos$oblig[datos$P7 == levels(datos$P7)[1]] <- 1

```

## Proporción de personas mayores de 18 años que dicen estar vacunadas

```{r}
table(datos$P5)[1:2]

# IC de wilson
prop.test(3590,nrow(datos))
```

## Cuales son los motivos para no vacunarse

```{r}
t1 <- table(datos$P5B)

t1 <- rev(sort(t1))

t2 <- prop.table(t1)

t3 <- cbind(t1,round(t2,3)*100)

t3 <- as.data.frame(t3)

t3
```


# Test de indpendencia

```{r}
chisq.test(datos$SEXO,datos$INTENCIONGR)
```


```{r}
chisq.test(datos$SEXO,datos$INTENCIONGR)
```




## Función propia Chisq.test







